# Mensageria

## O que é?

É um tipo de comunicação entre sistemas internos, microserviços.

Essa comunicação é assíncrona, ou seja, o remetente envia a mensagem e não precisa esperar uma resposta imediata. 

Aqui, essas mensagens são enviadas para as filas, que armazenam elas até serem consumidas por um consumer.

<hr>
<br>

## O que ela resolve?

1. Sistema travar:
     
     Muitas requisições simultâneas podem fazer o sistema travar, já que o processamento de cada requisição pode demorar.

     É como um caixa de supermercado. Se todo mundo tentasse ser atendido ao mesmo tempo, a atendente não daria conta.
     Por isso existe uma fila: as pessoas aguardam e são atendidas conforme a capacidade do caixa.
     
<br>

2. Perca de dados:
     
     Ao cair algum microservico, esses dados podem ser perdidos:

     Exemplo:

     Imagine que plataformas como Mercado Livre, Shopee ou Amazon utilizem APIs REST baseadas em HTTP.

     <br>

     Suponha que o Mercado Livre tenha dois microserviços principais:

     - Microserviço 1: Verificação do pagamento. (Consumer)
     - Microserviço 2: Notificação por e-mail confirmando o pagamento. (Producer)

     <br>

     O seu João faz a compra de uma cadeira gamer e realiza o pagamento via Pix. Como o processamento do pagamento pode levar um tempinho, ele precisa esperar pela confirmação. Nesse intervalo, se o microserviço de verificação de pagamento apresentar alguma falha ou cair, a confirmação não chega ao microserviço de notificação.

     Como resultado, o microserviço de envio de e-mail não é acionado, e o **seu João acaba não recebendo a confirmação do pagamento**. Isso evidencia a dependência direta entre os microserviços e o risco de falhas na comunicação, prejudicando a experiência do cliente.

     <br>

     Agora, olha a diferença quando utilizamos mensageria. 

     O seu João faz o pagamento da cadeira gamer via Pix, e essa informação é enviada para uma fila, onde a mensagem fica armazenada. Se o microserviço de verificação de pagamento cair, não tem problema. O microserviço de notificação por e-mail pode consumir a mensagem da fila assim que estiver disponível, independente do estado do microserviço 1. Isso garante que o e-mail de confirmação seja enviado para o seu Joao.

<br>
<br>

 Por que utilizar mensageria é bom?

1. O sistema não trava:
     Mesmo com muitas requisicoes.

<br>

2. Desacoplamento:
     Um microserviço não depende do outro estar disponível no mesmo momento. Eles se comunicam por mensagens, não diretamente.

<br>


<hr>
<br>

## comunicacao sincrona x assincrona

1. Comunicação Síncrona (Protocolo HTTP):
     
     O remetente envia uma requisição e precisa esperar a resposta antes de proseguir. Exemplo, Protocolo HTTP. Cliente espera a resposta do Servidor.

     <br>

1. Comunicação Assíncrona (Protocolo AMQP): O remente envia uma mensagem e não precisa esperar resposta. A mensagem é processada em segundo plano, permitindo que o sistema continue funcionando normalmente. Um exemplo é a mensageria com AMQP, onde as mensagens ficam em filas e são consumidas posteriormente.
